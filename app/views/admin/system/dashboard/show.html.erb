<div class="admin-content">
  <%# Page Header %>
  <div class="admin-page-header">
    <div>
      <h1 class="admin-page-title">Application Health</h1>
      <p class="admin-page-subtitle">System status, performance, and monitoring</p>
    </div>
    <div class="admin-section-nav">
      <%= link_to "System Status", admin_system_root_path, class: "admin-section-nav-item active" %>
      <%= link_to "Platform Usage", admin_system_usage_path, class: "admin-section-nav-item" %>
      <%= link_to "AI Analytics", admin_system_ai_path, class: "admin-section-nav-item" %>
      <%= link_to "Audit Activity", admin_system_audit_path, class: "admin-section-nav-item" %>
    </div>
  </div>

  <%# System Alerts %>
  <% @alerts.each do |alert| %>
    <div class="admin-alert-banner <%= alert[:type] %>">
      <div class="admin-alert-banner-icon">
        <% if alert[:type] == "error" %>
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <line x1="15" y1="9" x2="9" y2="15"/>
            <line x1="9" y1="9" x2="15" y2="15"/>
          </svg>
        <% else %>
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
            <line x1="12" y1="9" x2="12" y2="13"/>
            <line x1="12" y1="17" x2="12.01" y2="17"/>
          </svg>
        <% end %>
      </div>
      <div class="admin-alert-banner-content">
        <div class="admin-alert-banner-title"><%= alert[:title] %></div>
        <div class="admin-alert-banner-message"><%= alert[:message] %></div>
      </div>
    </div>
  <% end %>

  <% if @alerts.empty? %>
    <div class="admin-alert-banner success">
      <div class="admin-alert-banner-icon">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
          <polyline points="22 4 12 14.01 9 11.01"/>
        </svg>
      </div>
      <div class="admin-alert-banner-content">
        <div class="admin-alert-banner-title">All Systems Operational</div>
        <div class="admin-alert-banner-message">No alerts or issues detected</div>
      </div>
    </div>
  <% end %>

  <%# Hero Metrics %>
  <div class="admin-metric-hero">
    <div class="admin-metric-hero-card">
      <div class="admin-metric-hero-card-icon green">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
          <circle cx="9" cy="7" r="4"/>
        </svg>
      </div>
      <div class="admin-metric-hero-value"><%= number_with_delimiter(@active_sessions) %></div>
      <div class="admin-metric-hero-label">Active Sessions</div>
      <div class="admin-metric-hero-change neutral">Users online now</div>
    </div>

    <div class="admin-metric-hero-card">
      <div class="admin-metric-hero-card-icon <%= @queue_depth > 50 ? 'orange' : 'blue' %>">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="8" y1="6" x2="21" y2="6"/>
          <line x1="8" y1="12" x2="21" y2="12"/>
          <line x1="8" y1="18" x2="21" y2="18"/>
          <line x1="3" y1="6" x2="3.01" y2="6"/>
          <line x1="3" y1="12" x2="3.01" y2="12"/>
          <line x1="3" y1="18" x2="3.01" y2="18"/>
        </svg>
      </div>
      <div class="admin-metric-hero-value"><%= number_with_delimiter(@queue_depth) %></div>
      <div class="admin-metric-hero-label">Queue Depth</div>
      <div class="admin-metric-hero-change neutral">Background jobs waiting</div>
    </div>

    <div class="admin-metric-hero-card">
      <div class="admin-metric-hero-card-icon <%= @error_rate > 5 ? 'orange' : 'green' %>">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"/>
          <line x1="15" y1="9" x2="9" y2="15"/>
          <line x1="9" y1="9" x2="15" y2="15"/>
        </svg>
      </div>
      <div class="admin-metric-hero-value"><%= @error_rate %>%</div>
      <div class="admin-metric-hero-label">Error Rate (24h)</div>
      <div class="admin-metric-hero-change neutral">Job failure rate</div>
    </div>

    <div class="admin-metric-hero-card">
      <div class="admin-metric-hero-card-icon purple">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"/>
          <polyline points="12 6 12 12 16 14"/>
        </svg>
      </div>
      <div class="admin-metric-hero-value"><%= @avg_response_time %></div>
      <div class="admin-metric-hero-label">Avg Response Time</div>
      <div class="admin-metric-hero-change neutral">Request latency</div>
    </div>
  </div>

  <%# Background Jobs Status %>
  <div class="admin-grid-2 mb-6">
    <div class="admin-panel">
      <div class="admin-panel-header">
        <h2 class="admin-panel-title">Background Jobs Status</h2>
      </div>
      <div class="admin-panel-content">
        <div class="admin-stats-grid">
          <div class="admin-stat-item">
            <div class="admin-stat-label">Pending</div>
            <div class="admin-stat-value"><%= number_with_delimiter(@jobs_status[:pending]) %></div>
          </div>
          <div class="admin-stat-item">
            <div class="admin-stat-label">Failed</div>
            <div class="admin-stat-value" style="color: <%= @jobs_status[:failed] > 0 ? 'var(--color-error-pale0)' : 'inherit' %>;">
              <%= number_with_delimiter(@jobs_status[:failed]) %>
            </div>
          </div>
          <div class="admin-stat-item">
            <div class="admin-stat-label">Processed Today</div>
            <div class="admin-stat-value"><%= number_with_delimiter(@jobs_status[:processed_today]) %></div>
          </div>
        </div>
      </div>
    </div>

    <div class="admin-panel">
      <div class="admin-panel-header">
        <h2 class="admin-panel-title">Recent Errors</h2>
      </div>
      <% if @recent_errors.any? %>
        <ul class="recent-activity-list">
          <% @recent_errors.each do |error| %>
            <li class="recent-activity-item">
              <div class="recent-activity-info">
                <span class="recent-activity-name" style="color: var(--color-error);"><%= error[:job_class] %></span>
                <span class="recent-activity-meta"><%= error[:error] %></span>
              </div>
              <span class="recent-activity-time"><%= time_ago_in_words(error[:created_at]) %> ago</span>
            </li>
          <% end %>
        </ul>
      <% else %>
        <div class="admin-panel-content text-center py-6">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="var(--color-success-pale0)" stroke-width="2" style="margin: 0 auto var(--space-3);">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
            <polyline points="22 4 12 14.01 9 11.01"/>
          </svg>
          <p class="text-muted">No recent errors</p>
        </div>
      <% end %>
    </div>
  </div>

  <%# Quick Links %>
  <div class="admin-panel">
    <div class="admin-panel-header">
      <h2 class="admin-panel-title">Quick Actions</h2>
    </div>
    <div class="admin-quick-links">
      <%= link_to admin_audit_logs_path, class: "admin-quick-link" do %>
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
          <polyline points="14 2 14 8 20 8"/>
        </svg>
        View Audit Logs
      <% end %>
      <%= link_to admin_system_usage_path, class: "admin-quick-link" do %>
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>
        </svg>
        Platform Usage
      <% end %>
      <%= link_to admin_system_ai_path, class: "admin-quick-link" do %>
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 8V4H8"/>
          <rect width="16" height="12" x="4" y="8" rx="2"/>
        </svg>
        AI Analytics
      <% end %>
      <%= link_to admin_settings_path, class: "admin-quick-link" do %>
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="3"/>
          <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
        </svg>
        Platform Settings
      <% end %>
    </div>
  </div>
</div>
