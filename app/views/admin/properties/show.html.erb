<div class="admin-content">
  <%# Back Link %>
  <div class="mb-4">
    <%= link_to admin_properties_path, class: "btn btn-ghost btn-sm" do %>
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="15 18 9 12 15 6"/>
      </svg>
      Back to Properties
    <% end %>
  </div>

  <%# Property Header %>
  <div class="admin-user-header mb-6">
    <div class="admin-user-header-main">
      <% if @property.hero_image.attached? %>
        <%= image_tag @property.hero_image, class: "admin-property-image", style: "width: 150px; height: 100px;" %>
      <% else %>
        <div class="admin-property-image" style="width: 150px; height: 100px; display: flex; align-items: center; justify-content: center;">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="color: var(--color-gray-300);">
            <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
            <polyline points="9 22 9 12 15 12 15 22"/>
          </svg>
        </div>
      <% end %>
      <div class="admin-user-header-info">
        <h1 class="admin-user-name"><%= @property.address %></h1>
        <p class="admin-user-email"><%= @property.suburb %>, <%= @property.state %> <%= @property.postcode %></p>
        <div class="admin-user-badges">
          <span class="badge <%= property_status_badge_class(@property.status) %>">
            <%= @property.status&.humanize || "Draft" %>
          </span>
          <% if @property.featured? %>
            <span class="badge badge-orange">Featured</span>
          <% end %>
          <span class="badge badge-gray"><%= @property.property_type&.humanize || "House" %></span>
        </div>
      </div>
    </div>
    <div class="admin-user-header-actions">
      <%= link_to edit_admin_property_path(@property), class: "btn btn-secondary" do %>
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
          <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
        </svg>
        Edit
      <% end %>
      <% if @property.status == "pending" %>
        <%= button_to approve_admin_property_path(@property), method: :post, class: "btn btn-primary" do %>
          Approve
        <% end %>
        <%= button_to reject_admin_property_path(@property), method: :post, class: "btn btn-danger" do %>
          Reject
        <% end %>
      <% end %>
      <% if @property.featured? %>
        <%= button_to unfeature_admin_property_path(@property), method: :post, class: "btn btn-secondary" do %>
          Remove Feature
        <% end %>
      <% else %>
        <%= button_to feature_admin_property_path(@property), method: :post, class: "btn btn-secondary" do %>
          Feature
        <% end %>
      <% end %>
    </div>
  </div>

  <div class="admin-grid-2">
    <%# Property Details %>
    <div class="admin-panel">
      <div class="admin-panel-header">
        <h2 class="admin-panel-title">Details</h2>
      </div>
      <div class="admin-detail-list">
        <div class="admin-detail-row">
          <span class="admin-detail-label">ID</span>
          <span class="admin-detail-value"><%= @property.id %></span>
        </div>
        <div class="admin-detail-row">
          <span class="admin-detail-label">Price</span>
          <span class="admin-detail-value"><%= @property.price_cents ? number_to_currency(@property.price_cents / 100, precision: 0) : "Not set" %></span>
        </div>
        <div class="admin-detail-row">
          <span class="admin-detail-label">Property Type</span>
          <span class="admin-detail-value"><%= @property.property_type&.humanize || "House" %></span>
        </div>
        <div class="admin-detail-row">
          <span class="admin-detail-label">Bedrooms</span>
          <span class="admin-detail-value"><%= @property.bedrooms %></span>
        </div>
        <div class="admin-detail-row">
          <span class="admin-detail-label">Bathrooms</span>
          <span class="admin-detail-value"><%= @property.bathrooms %></span>
        </div>
        <div class="admin-detail-row">
          <span class="admin-detail-label">Parking</span>
          <span class="admin-detail-value"><%= @property.parking_spaces %></span>
        </div>
        <div class="admin-detail-row">
          <span class="admin-detail-label">Land Size</span>
          <span class="admin-detail-value"><%= @property.land_size_sqm %> sqm</span>
        </div>
        <div class="admin-detail-row">
          <span class="admin-detail-label">Floor Area</span>
          <span class="admin-detail-value"><%= @property.floor_area_sqm %> sqm</span>
        </div>
      </div>
    </div>

    <%# Seller & Listing Info %>
    <div class="admin-panel">
      <div class="admin-panel-header">
        <h2 class="admin-panel-title">Listing Info</h2>
      </div>
      <div class="admin-detail-list">
        <div class="admin-detail-row">
          <span class="admin-detail-label">Seller</span>
          <span class="admin-detail-value">
            <% if @property.seller %>
              <%= link_to @property.seller.name, admin_user_path(@property.seller) %>
            <% else %>
              N/A
            <% end %>
          </span>
        </div>
        <div class="admin-detail-row">
          <span class="admin-detail-label">Listed Date</span>
          <span class="admin-detail-value"><%= @property.created_at.strftime("%B %d, %Y") %></span>
        </div>
        <div class="admin-detail-row">
          <span class="admin-detail-label">Last Updated</span>
          <span class="admin-detail-value"><%= @property.updated_at.strftime("%B %d, %Y at %I:%M %p") %></span>
        </div>
        <div class="admin-detail-row">
          <span class="admin-detail-label">Views</span>
          <span class="admin-detail-value"><%= @property.views_count || 0 %></span>
        </div>
        <div class="admin-detail-row">
          <span class="admin-detail-label">Enquiries</span>
          <span class="admin-detail-value"><%= @property.enquiries_count || 0 %></span>
        </div>
        <div class="admin-detail-row">
          <span class="admin-detail-label">Loves</span>
          <span class="admin-detail-value"><%= @property.loves_count || 0 %></span>
        </div>
      </div>
    </div>
  </div>

  <%# Description %>
  <div class="admin-panel mt-6">
    <div class="admin-panel-header">
      <h2 class="admin-panel-title">Description</h2>
    </div>
    <div class="admin-panel-content">
      <p class="text-sm" style="color: var(--color-gray-600); line-height: 1.6;">
        <%= @property.description || "No description provided." %>
      </p>
    </div>
  </div>

  <%# Images Gallery %>
  <% if @property.photos.attached? %>
    <div class="admin-panel mt-6">
      <div class="admin-panel-header">
        <h2 class="admin-panel-title">Photos (<%= @property.photos.count %>)</h2>
      </div>
      <div class="admin-panel-content">
        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: var(--space-3);">
          <% @property.photos.each do |photo| %>
            <%= image_tag photo, style: "width: 100%; height: 100px; object-fit: cover; border-radius: var(--radius-md);" %>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>

  <%# Danger Zone %>
  <div class="admin-panel mt-6" style="border-color: var(--color-error-pale);">
    <div class="admin-panel-header" style="background: var(--color-error-pale);">
      <h2 class="admin-panel-title" style="color: var(--color-error-dark);">Danger Zone</h2>
    </div>
    <div class="admin-panel-content">
      <p class="text-sm mb-4" style="color: var(--color-gray-600);">
        Permanently delete this property and all associated data. This action cannot be undone.
      </p>
      <%= button_to admin_property_path(@property), method: :delete, class: "btn btn-danger", data: { turbo_confirm: "Are you sure you want to delete this property? This action cannot be undone." } do %>
        Delete Property
      <% end %>
    </div>
  </div>
</div>
